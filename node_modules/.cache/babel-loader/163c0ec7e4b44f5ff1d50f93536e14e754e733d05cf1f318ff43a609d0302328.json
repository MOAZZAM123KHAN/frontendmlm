{"ast":null,"code":"import _objectSpread from\"C:/Users/moazz/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext();export function CartProvider(_ref){let{userId='guest',children}=_ref;const storageKey=\"cart_\".concat(userId);const[cart,setCart]=useState([]);const[isLoading,setIsLoading]=useState(true);// Load cart from localStorage\nuseEffect(()=>{try{const stored=localStorage.getItem(storageKey);if(stored){const parsed=JSON.parse(stored);if(Array.isArray(parsed)){setCart(parsed);}else{console.warn('Invalid cart data in localStorage, resetting');localStorage.removeItem(storageKey);}}}catch(error){console.error('Error loading cart from localStorage:',error);localStorage.removeItem(storageKey);}finally{setIsLoading(false);}},[userId,storageKey]);// Save cart to localStorage\nuseEffect(()=>{if(!isLoading){try{localStorage.setItem(storageKey,JSON.stringify(cart));console.log('Cart saved:',cart);// Debug log\n}catch(error){console.error('Error saving cart to localStorage:',error);}}},[cart,userId,storageKey,isLoading]);const addToCart=function(product){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;console.log('Adding to cart:',product,quantity);// Debug log\nif(!product||!product.id){console.error('Invalid product data:',product);return;}setCart(prev=>{const existingItemIndex=prev.findIndex(item=>item.id===product.id);if(existingItemIndex!==-1){// Update existing item quantity\nconst updated=[...prev];updated[existingItemIndex].quantity+=quantity;console.log('Updated existing item:',updated[existingItemIndex]);return updated;}else{// Add new item\nconst newItem={id:product.id,name:product.name,price:Number(product.price)||0,image:product.image,quantity:quantity,mlmPoints:product.mlmPoints||0};console.log('Added new item:',newItem);return[...prev,newItem];}});};const removeFromCart=productId=>{console.log('Removing from cart:',productId);// Debug log\nsetCart(prev=>prev.filter(item=>item.id!==productId));};const updateQuantity=(productId,quantity)=>{const qty=Math.max(1,Number(quantity)||1);console.log('Updating quantity:',productId,qty);// Debug log\nsetCart(prev=>prev.map(item=>item.id===productId?_objectSpread(_objectSpread({},item),{},{quantity:qty}):item));};const clearCart=()=>{console.log('Clearing cart');// Debug log\nsetCart([]);};// Calculate totals\nconst cartTotal=cart.reduce((sum,item)=>sum+item.price*item.quantity,0);const itemCount=cart.reduce((sum,item)=>sum+item.quantity,0);console.log('Cart state:',{cart,cartTotal,itemCount,userId});// Debug log\nreturn/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,addToCart,removeFromCart,updateQuantity,clearCart,cartTotal,itemCount,isLoading},children:children});}export function useCart(){const context=useContext(CartContext);if(!context){throw new Error('useCart must be used within a CartProvider');}return context;}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","CartContext","CartProvider","_ref","userId","children","storageKey","concat","cart","setCart","isLoading","setIsLoading","stored","localStorage","getItem","parsed","JSON","parse","Array","isArray","console","warn","removeItem","error","setItem","stringify","log","addToCart","product","quantity","arguments","length","undefined","id","prev","existingItemIndex","findIndex","item","updated","newItem","name","price","Number","image","mlmPoints","removeFromCart","productId","filter","updateQuantity","qty","Math","max","map","_objectSpread","clearCart","cartTotal","reduce","sum","itemCount","Provider","value","useCart","context","Error"],"sources":["C:/Users/moazz/Desktop/frontend/src/components/ecommerce/CartContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport function CartProvider({ userId = 'guest', children }) {\r\n  const storageKey = `cart_${userId}`;\r\n  const [cart, setCart] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // Load cart from localStorage\r\n  useEffect(() => {\r\n    try {\r\n      const stored = localStorage.getItem(storageKey);\r\n      if (stored) {\r\n        const parsed = JSON.parse(stored);\r\n        if (Array.isArray(parsed)) {\r\n          setCart(parsed);\r\n        } else {\r\n          console.warn('Invalid cart data in localStorage, resetting');\r\n          localStorage.removeItem(storageKey);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading cart from localStorage:', error);\r\n      localStorage.removeItem(storageKey);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [userId, storageKey]);\r\n\r\n  // Save cart to localStorage\r\n  useEffect(() => {\r\n    if (!isLoading) {\r\n      try {\r\n        localStorage.setItem(storageKey, JSON.stringify(cart));\r\n        console.log('Cart saved:', cart); // Debug log\r\n      } catch (error) {\r\n        console.error('Error saving cart to localStorage:', error);\r\n      }\r\n    }\r\n  }, [cart, userId, storageKey, isLoading]);\r\n\r\n  const addToCart = (product, quantity = 1) => {\r\n    console.log('Adding to cart:', product, quantity); // Debug log\r\n    \r\n    if (!product || !product.id) {\r\n      console.error('Invalid product data:', product);\r\n      return;\r\n    }\r\n    \r\n    setCart(prev => {\r\n      const existingItemIndex = prev.findIndex(item => item.id === product.id);\r\n      \r\n      if (existingItemIndex !== -1) {\r\n        // Update existing item quantity\r\n        const updated = [...prev];\r\n        updated[existingItemIndex].quantity += quantity;\r\n        console.log('Updated existing item:', updated[existingItemIndex]);\r\n        return updated;\r\n      } else {\r\n        // Add new item\r\n        const newItem = {\r\n          id: product.id,\r\n          name: product.name,\r\n          price: Number(product.price) || 0,\r\n          image: product.image,\r\n          quantity: quantity,\r\n          mlmPoints: product.mlmPoints || 0\r\n        };\r\n        console.log('Added new item:', newItem);\r\n        return [...prev, newItem];\r\n      }\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (productId) => {\r\n    console.log('Removing from cart:', productId); // Debug log\r\n    setCart(prev => prev.filter(item => item.id !== productId));\r\n  };\r\n\r\n  const updateQuantity = (productId, quantity) => {\r\n    const qty = Math.max(1, Number(quantity) || 1);\r\n    console.log('Updating quantity:', productId, qty); // Debug log\r\n    setCart(prev => prev.map(item => \r\n      item.id === productId ? { ...item, quantity: qty } : item\r\n    ));\r\n  };\r\n\r\n  const clearCart = () => {\r\n    console.log('Clearing cart'); // Debug log\r\n    setCart([]);\r\n  };\r\n\r\n  // Calculate totals\r\n  const cartTotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);\r\n  const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);\r\n\r\n  console.log('Cart state:', { cart, cartTotal, itemCount, userId }); // Debug log\r\n\r\n  return (\r\n    <CartContext.Provider value={{ \r\n      cart, \r\n      addToCart, \r\n      removeFromCart, \r\n      updateQuantity, \r\n      clearCart,\r\n      cartTotal,\r\n      itemCount,\r\n      isLoading\r\n    }}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useCart() {\r\n  const context = useContext(CartContext);\r\n  if (!context) {\r\n    throw new Error('useCart must be used within a CartProvider');\r\n  }\r\n  return context;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}